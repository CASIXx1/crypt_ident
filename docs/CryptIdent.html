<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Module: CryptIdent
  
    &mdash; Documentation by YARD 0.9.16
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "CryptIdent";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index (C)</a> &raquo;
    
    
    <span class="title">CryptIdent</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Module: CryptIdent
  
  
  
</h1>
<div class="box_info">
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/crypt_ident.rb<span class="defines">,<br />
  lib/crypt_ident/version.rb</span>
</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>Include and interact with <code>CryptIdent</code> to add authentication to a
Hanami controller action.</p>

<p>Note the emphasis on <em>controller action</em>; this module interacts with session
data, which is quite theoretically possible in an Interactor but practically
<em>quite</em> the PITA. YHBW.</p>

<p>FIXME: Disable :reek:UnusedParameters; we have not yet added code.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Author:</p>
<ul class="author">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>Jeff Dickey</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Version:</p>
<ul class="version">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>0.1.0</p>
</div>
      
    </li>
  
</ul>

</div>
  
    <h2>
      Constant Summary
      <small><a href="#" class="constants_summary_toggle">collapse</a></small>
    </h2>

    <dl class="constants">
      
        <dt id="VERSION-constant" class="">VERSION =
          <div class="docstring">
  <div class="discussion">
    <p>Version number for Gem. Uses Semantic Versioning.</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>0.1.0</span><span class='tstring_end'>&#39;</span></span></pre></dd>
      
    </dl>
  







  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#configure_crypt_ident-class_method" title="configure_crypt_ident (class method)">.<strong>configure_crypt_ident</strong>(&amp;block)  </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Set configuration information at the class (actually, module) level.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_password-instance_method" title="#add_password (instance method)">#<strong>add_password</strong>(other_params, password)  &#x21d2; Hash </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Build a Hash of attributes suitable for instantiating and persisting an Entity, with a <code>:hashed_password</code> attribute containing the encrypted value of the Clear-Text Password passed in as a parameter.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#change_password-instance_method" title="#change_password (instance method)">#<strong>change_password</strong>(current_password, new_password, new_confirmation)  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Change an Authenticated User&#39;s password.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#generate_reset_token-instance_method" title="#generate_reset_token (instance method)">#<strong>generate_reset_token</strong>(user_name)  &#x21d2; Symbol, true </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Request a Password Reset Token.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#reset_password-instance_method" title="#reset_password (instance method)">#<strong>reset_password</strong>(token, new_password, confirmation)  &#x21d2; Symbol, true </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Reset the password for the User associated with a Password Reset Token.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#restart_session_counter-instance_method" title="#restart_session_counter (instance method)">#<strong>restart_session_counter</strong>  </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Restart the Session Expiration timestamp mechanism, to avoid prematurely signing out a User.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#session_expired%3F-instance_method" title="#session_expired? (instance method)">#<strong>session_expired?</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Determine whether the Session has Expired due to User inactivity.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#sign_in-instance_method" title="#sign_in (instance method)">#<strong>sign_in</strong>(user, password)  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Attempt to Authenticate a User, passing in an Entity for that User (which <strong>must</strong> contain a <code>password_hash</code> attribute), and a Clear-Text Password.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#sign_out-instance_method" title="#sign_out (instance method)">#<strong>sign_out</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Sign out a previously Authenticated User.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="configure_crypt_ident-class_method">
  
    .<strong>configure_crypt_ident</strong>(&amp;block)  
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p><p>Set configuration information at the class (actually, module) level.</p>

<p><strong>IMPORTANT:</strong> Even though we follow time-honoured convention
here and call the variable yielded by the <code>CryptIdent.configure_crypt_ident</code>
block <code>config</code>, settings <em>are not</em> being stored in an <em>instance variable</em>
called <code>@config</code>. That is <em>too likely</em> to conflict with something Important;
remember, we&#39;re a module, not a class, and good table manners are <em>also</em>
Important.</p>

<p>This is normally run from the <code>controller.prepare</code> block inside your app&#39;s
<code>apps/&lt;app name&gt;/application.rb</code> file, where the default for <code>app_name</code> in a
Hanami app is <code>web</code>.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='const'><span class='object_link'><a href="" title="CryptIdent (module)">CryptIdent</a></span></span><span class='period'>.</span><span class='id identifier rubyid_configure_crypt_ident'>configure_crypt_ident</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_config'>config</span><span class='op'>|</span>
  <span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_repository'>repository</span> <span class='op'>=</span> <span class='const'>MainApp</span><span class='op'>::</span><span class='const'>Repositories</span><span class='op'>::</span><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_error_key'>error_key</span> <span class='op'>=</span> <span class='symbol'>:alert</span>
  <span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_hashing_cost'>hashing_cost</span> <span class='op'>=</span> <span class='int'>6</span> <span class='comment'># less secure and less resource-intensive
</span>  <span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_token_bytes'>token_bytes</span> <span class='op'>=</span> <span class='int'>20</span>
  <span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_reset_expiry'>reset_expiry</span> <span class='op'>=</span> <span class='int'>7200</span> <span class='comment'># two hours; &quot;we run a tight ship here&quot;
</span>  <span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_guest_user'>guest_user</span> <span class='op'>=</span> <span class='const'>UserRepository</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='period'>.</span><span class='id identifier rubyid_guest_user'>guest_user</span>
<span class='kw'>end</span></code></pre>
    
  </div>

<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>0.1.0</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Required Authentication Status:</p>
<ul class="authenticated">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>Irrelevant; normally called during framework setup.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Session Data Interacted With:</p>
<ul class="session_data">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>Irrelevant; normally called during framework setup.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Ubiquitous Language Terms:</p>
<ul class="ubiq_lang">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>None; only related to demonstrated configuration settings.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


44
45
46</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/crypt_ident.rb', line 44</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_configure_crypt_ident'>configure_crypt_ident</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='comment'># To be implemented.
</span><span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="add_password-instance_method">
  
    #<strong>add_password</strong>(other_params, password)  &#x21d2; <tt>Hash</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Build a Hash of attributes suitable for instantiating and persisting an
Entity, with a <code>:hashed_password</code> attribute containing the encrypted value
of the Clear-Text Password passed in as a parameter.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='kw'>def</span> <span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span> <span class='comment'># #valid? has already returned `true`
</span>  <span class='id identifier rubyid_password'>password</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:password</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_others'>others</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_reject'>reject</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid__'>_</span><span class='op'>|</span> <span class='id identifier rubyid_k'>k</span> <span class='op'>==</span> <span class='symbol'>:password</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_attribs'>attribs</span> <span class='op'>=</span> <span class='id identifier rubyid_add_password'>add_password</span><span class='lparen'>(</span><span class='id identifier rubyid_others'>others</span><span class='comma'>,</span> <span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_repo'>repo</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='id identifier rubyid_attribs'>attribs</span><span class='rparen'>)</span>
<span class='kw'>end</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>other_params</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>Hash of Entity attributes <em>not</em> including
any password attributes.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>password</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>New Clear-Text Password to encrypt and add to
return value</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>Entity attributes, including encrypted <code>password_hash</code>.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>0.1.0</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Required Authentication Status:</p>
<ul class="authenticated">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>Must not be authenticated.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Session Data Interacted With:</p>
<ul class="session_data">
  
    <li>
      
      
      
      
        
        <div class='inline'><p><code>:current_user</code> <strong>must not</strong> be other than <code>nil</code> or the Guest User.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Ubiquitous Language Terms:</p>
<ul class="ubiq_lang">
  
    <li>
      
      
      
      
        
        <div class='inline'><ul>
<li>Authentication</li>
<li>Clear-Text Password</li>
<li>Entity</li>
<li>Guest User</li>
</ul>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


76
77
78</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/crypt_ident.rb', line 76</span>

<span class='kw'>def</span> <span class='id identifier rubyid_add_password'>add_password</span><span class='lparen'>(</span><span class='id identifier rubyid_other_params'>other_params</span><span class='comma'>,</span> <span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span>
  <span class='comment'># To be implemented.
</span><span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="change_password-instance_method">
  
    #<strong>change_password</strong>(current_password, new_password, new_confirmation)  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Change an Authenticated User&#39;s password.</p>

<p>To change an Authenticated User&#39;s password, the current Clear-Text Password,
new Clear-Text Password, and Clear-Text Password Confirmation are passed in
as parameters.</p>

<p>If the Encrypted Password in the <code>session[:current_user]</code> Entity does
not match the encrypted value of the specified current Clear-Text Password,
then the method returns <code>:bad_password</code> and no changes occur.</p>

<p>If the current-password check succeeds but the new Clear-Text Password and
its confirmation do not match, then the method returns
<code>:mismatched_password</code> and no changes occur.</p>

<p>If the new Clear-Text Password and its confirmation match, then the
<em>encrypted value</em> of that new Password is returned, and the
<code>session[:current_user]</code> Entity is replaced with an Entity identical
except that it has the new encrypted value for <code>hashed_password</code>. The entry
in the Repository for the current User has also been updated to include the
new Encrypted Password.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='kw'>def</span> <span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_user'>user</span> <span class='op'>=</span> <span class='id identifier rubyid_session'>session</span><span class='lbracket'>[</span><span class='symbol'>:current_user</span><span class='rbracket'>]</span>
  <span class='const'>UserRepository</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='period'>.</span><span class='id identifier rubyid_update'>update</span><span class='lparen'>(</span><span class='id identifier rubyid_user'>user</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='id identifier rubyid_user'>user</span><span class='rparen'>)</span> <span class='comment'># updated user saved to repo
</span><span class='kw'>end</span>

<span class='id identifier rubyid_private'>private</span>

<span class='kw'>def</span> <span class='id identifier rubyid_valid?'>valid?</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_mismatch_message'>mismatch_message</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>New password and confirmation do not match.</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_change_password'>change_password</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:password</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:new_password</span><span class='rbracket'>]</span><span class='comma'>,</span>
                           <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:confirmation</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>case</span> <span class='id identifier rubyid_result'>result</span>
  <span class='kw'>when</span> <span class='symbol'>:bad_password</span> <span class='kw'>then</span> <span class='id identifier rubyid_error!'>error!</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Invalid current password supplied.</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='kw'>when</span> <span class='symbol'>:mismatched_password</span> <span class='kw'>then</span> <span class='id identifier rubyid_error!'>error!</span><span class='lparen'>(</span><span class='id identifier rubyid_mismatch_message'>mismatch_message</span><span class='rparen'>)</span>
  <span class='kw'>end</span> <span class='comment'># else `session[:current_user]` has been updated
</span><span class='kw'>end</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>current_password</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The current Clear-Text Password for the
Current User</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>new_password</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The new Clear-Text Password to encrypt and add
the current-user entity</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>0.1.0</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Required Authentication Status:</p>
<ul class="authenticated">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>Must be authenticated.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Session Data Interacted With:</p>
<ul class="session_data">
  
    <li>
      
      
      
      
        
        <div class='inline'><p><code>:current_user</code> <strong>must</strong> be an Entity for a Registered User</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Ubiquitous Language Terms:</p>
<ul class="ubiq_lang">
  
    <li>
      
      
      
      
        
        <div class='inline'><ul>
<li>Authentication</li>
<li>Clear-Text Password</li>
<li>Clear-Text Password Confirmation</li>
<li>Encrypted Password</li>
<li>Entity</li>
<li>Guest User</li>
<li>Registered User</li>
<li>Repository</li>
</ul>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


237
238
239</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/crypt_ident.rb', line 237</span>

<span class='kw'>def</span> <span class='id identifier rubyid_change_password'>change_password</span><span class='lparen'>(</span><span class='id identifier rubyid_current_password'>current_password</span><span class='comma'>,</span> <span class='id identifier rubyid_new_password'>new_password</span><span class='comma'>,</span> <span class='id identifier rubyid_new_confirmation'>new_confirmation</span><span class='rparen'>)</span>
  <span class='comment'># To be implemented.
</span><span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="generate_reset_token-instance_method">
  
    #<strong>generate_reset_token</strong>(user_name)  &#x21d2; <tt>Symbol</tt>, <tt>true</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Request a Password Reset Token</p>

<p>Password Reset Tokens are useful for verifying that the person requesting a
Password Reset for an existing User is sufficiently likely to be the person
who Registered that User or, if not, that no compromise or other harm is
done.</p>

<p>Typically, this is done by sending a link through email or other such medium
to the address previously associated with the User purportedly requesting
the Password Reset. <code>CryptIdent</code> <em>does not</em> automate generation or sending
of the email message. What it <em>does</em> provide is a method to generate a new
Password Reset Token to be embedded into an HTML anchor link within an email
that you construct.</p>

<p>It also implements an expiry system, such that if the confirmation of the
Password Reset request is not completed within a configurable time, that the
token is no longer valid (and so cannot be later reused by unauthorised
persons).</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='kw'>def</span> <span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_send_reset_email'>send_reset_email</span> <span class='kw'>if</span> <span class='id identifier rubyid_valid_request?'>valid_request?</span>
<span class='kw'>end</span>

<span class='id identifier rubyid_private'>private</span>

<span class='kw'>def</span> <span class='id identifier rubyid_send_result_email'>send_result_email</span>
  <span class='comment'># will use @user_name and @token to generate and send email
</span><span class='kw'>end</span>

<span class='kw'>def</span> <span class='id identifier rubyid_valid_request?'>valid_request?</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_logged_in_error'>logged_in_error</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Cannot request password reset while logged in!</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_not_found_error'>not_found_error</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Cannot find specified user in repository</span><span class='tstring_end'>&#39;</span></span>
  <span class='ivar'>@user_name</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:name</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Unknown User</span><span class='tstring_end'>&#39;</span></span>
  <span class='ivar'>@token</span> <span class='op'>=</span> <span class='kw'>case</span> <span class='id identifier rubyid_generate_reset_token'>generate_reset_token</span><span class='lparen'>(</span><span class='id identifier rubyid_user_name'>user_name</span><span class='rparen'>)</span>
  <span class='kw'>when</span> <span class='symbol'>:user_logged_in</span> <span class='kw'>then</span> <span class='id identifier rubyid_error!'>error!</span><span class='lparen'>(</span><span class='id identifier rubyid_logged_in_error'>logged_in_error</span><span class='rparen'>)</span>
  <span class='kw'>when</span> <span class='symbol'>:user_not_found</span> <span class='kw'>then</span> <span class='id identifier rubyid_error!'>error!</span><span class='lparen'>(</span><span class='id identifier rubyid_not_found_error'>not_found_error</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>user_name</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The name of the User for whom a Password Reset
Token is to be generated.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Symbol</tt>, <tt>true</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>True on success or error identifier on failure.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>0.1.0</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Required Authentication Status:</p>
<ul class="authenticated">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>Must not be authenticated.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Session Data Interacted With:</p>
<ul class="session_data">
  
    <li>
      
      
      
      
        
        <div class='inline'><p><code>:current_user</code> <strong>must not</strong> be other than <code>nil</code> or the Guest User.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Ubiquitous Language Terms:</p>
<ul class="ubiq_lang">
  
    <li>
      
      
      
      
        
        <div class='inline'><ul>
<li>Authentication</li>
<li>Password Reset Token</li>
<li>Registered User</li>
</ul>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


294
295
296</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/crypt_ident.rb', line 294</span>

<span class='kw'>def</span> <span class='id identifier rubyid_generate_reset_token'>generate_reset_token</span><span class='lparen'>(</span><span class='id identifier rubyid_user_name'>user_name</span><span class='rparen'>)</span>
  <span class='comment'># To be implemented.
</span><span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="reset_password-instance_method">
  
    #<strong>reset_password</strong>(token, new_password, confirmation)  &#x21d2; <tt>Symbol</tt>, <tt>true</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Reset the password for the User associated with a Password Reset Token.</p>

<p>After a Password Reset Token has been
<a href="#generate_reset_token-instance_method">generated</a> to a User, that User
would then exercise the Client system and perform a Password Reset.</p>

<p>Again, this differs from a
<a href="#change_password-instance-method">Change Password</a> activity since the User
in question <em>is not Authenticated</em> at the time of the action.</p>

<p>The <code>#reset_password</code> method is called with a Password Reset Token, a new
Clear-Text Password, and a Clear-Text Password Confirmation.</p>

<p>If the token is invalid or has expired, <code>reset_password</code> returns a value of
<code>:invalid_token</code>.</p>

<p>If the new password and confirmation do not match, <code>reset_password</code> returns
<code>:mismatched_password</code>.</p>

<p>If the new Clear-Text Password and its confirmation match, then the
value of that new Encrypted Password is returned, and the Repository record
for that Registered User is updated to include the new Encrypted Password.</p>

<p>In no event are session values, including the Current User, changed. After a
successful Password Reset, the User must Authenticate as usual.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='kw'>def</span> <span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>unless</span> <span class='id identifier rubyid_params_valid?'>params_valid?</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_flash'>flash</span><span class='lbracket'>[</span><span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_success_key'>success_key</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>You have reset your password. Please </span><span class='tstring_end'>&#39;</span></span> \
                              <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>sign in.</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_redirect_to'>redirect_to</span> <span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_root_path'>root_path</span>
<span class='kw'>end</span>

<span class='id identifier rubyid_private'>private</span>

<span class='kw'>def</span> <span class='id identifier rubyid_params_valid?'>params_valid?</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_invalid_token_error'>invalid_token_error</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Invalid or expired token. Request reset again.</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_mismatch_error'>mismatch_error</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>New password and confirmation do not match</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_reset_password'>reset_password</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:token</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:new_password</span><span class='rbracket'>]</span><span class='comma'>,</span>
                          <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:confirmation</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>case</span> <span class='id identifier rubyid_result'>result</span>
  <span class='kw'>when</span> <span class='symbol'>:invalid_token</span> <span class='kw'>then</span> <span class='id identifier rubyid_error!'>error!</span><span class='lparen'>(</span><span class='id identifier rubyid_invalid_token_error'>invalid_token_error</span><span class='rparen'>)</span>
  <span class='kw'>when</span> <span class='symbol'>:mismatched_password</span> <span class='kw'>then</span> <span class='id identifier rubyid_error!'>error!</span><span class='lparen'>(</span><span class='id identifier rubyid_mismatch_error'>mismatch_error</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>token</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The Password Reset Token previously communicated to
the User.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>new_password</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>New Clear-Text Password to encrypt and add to
return value</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>confirmation</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>Clear-Text Password Confirmation.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Symbol</tt>, <tt>true</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>True on success or error identifier on failure.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>0.1.0</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Required Authentication Status:</p>
<ul class="authenticated">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>Must not be authenticated.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Session Data Interacted With:</p>
<ul class="session_data">
  
    <li>
      
      
      
      
        
        <div class='inline'><p><code>:current_user</code> <strong>must not</strong> be other than <code>nil</code> or the Guest User.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Ubiquitous Language Terms:</p>
<ul class="ubiq_lang">
  
    <li>
      
      
      
      
        
        <div class='inline'><ul>
<li>Authentication</li>
<li>Clear-Text Password</li>
<li>Clear-Text Password Confirmation</li>
<li>Encrypted Password</li>
<li>Password Reset Token</li>
<li>Registered User</li>
</ul>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


363
364
365</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/crypt_ident.rb', line 363</span>

<span class='kw'>def</span> <span class='id identifier rubyid_reset_password'>reset_password</span><span class='lparen'>(</span><span class='id identifier rubyid_token'>token</span><span class='comma'>,</span> <span class='id identifier rubyid_new_password'>new_password</span><span class='comma'>,</span> <span class='id identifier rubyid_confirmation'>confirmation</span><span class='rparen'>)</span>
  <span class='comment'># To be implemented.
</span><span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="restart_session_counter-instance_method">
  
    #<strong>restart_session_counter</strong>  
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p><p>Restart the Session Expiration timestamp mechanism, to avoid prematurely
signing out a User.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='kw'>def</span> <span class='id identifier rubyid_validate_session'>validate_session</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_restart_session_counter'>restart_session_counter</span> <span class='kw'>unless</span> <span class='id identifier rubyid_session_expired?'>session_expired?</span>

  <span class='comment'># ... sign out and redirect appropriately ...
</span><span class='kw'>end</span></code></pre>
    
  </div>

<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>0.1.0</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Required Authentication Status:</p>
<ul class="authenticated">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>Must be authenticated.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Session Data Interacted With:</p>
<ul class="session_data">
  
    <li>
      
      
      
      
        
        <div class='inline'><p><code>:current_user</code> <strong>must</strong> be an Entity for a Registered User on entry
<code>:start_time</code>   set to <code>Time.now</code> on exit</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Ubiquitous Language Terms:</p>
<ul class="ubiq_lang">
  
    <li>
      
      
      
      
        
        <div class='inline'><ul>
<li>Authentication</li>
<li>Session Expiration</li>
</ul>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


388
389
390</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/crypt_ident.rb', line 388</span>

<span class='kw'>def</span> <span class='id identifier rubyid_restart_session_counter'>restart_session_counter</span>
  <span class='comment'># To be implemented.
</span><span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="session_expired?-instance_method">
  
    #<strong>session_expired?</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Determine whether the Session has Expired due to User inactivity.</p>

<p>This is determined by comparing the current time as reported by <code>Time.now</code>
to the timestamp resulting from adding <code>session[:start_time]</code> and
<code>config.session_expiry</code>.</p>

<p>Will return <code>false</code> if <code>session[:current_user]</code> is <code>nil</code> or has the value
specified by <code>config.guest_user</code>.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='kw'>def</span> <span class='id identifier rubyid_validate_session'>validate_session</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_restart_session_counter'>restart_session_counter</span> <span class='kw'>unless</span> <span class='id identifier rubyid_session_expired?'>session_expired?</span>

  <span class='comment'># ... sign out and redirect appropriately ...
</span><span class='kw'>end</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>0.1.0</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Required Authentication Status:</p>
<ul class="authenticated">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>Must be authenticated.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Session Data Interacted With:</p>
<ul class="session_data">
  
    <li>
      
      
      
      
        
        <div class='inline'><p><code>:current_user</code> <strong>must</strong> be an Entity for a Registered User on entry
<code>:start_time</code>   read during determination of expiry status</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Ubiquitous Language Terms:</p>
<ul class="ubiq_lang">
  
    <li>
      
      
      
      
        
        <div class='inline'><ul>
<li>Authentication</li>
<li>Session Expiration</li>
</ul>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


417
418
419</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/crypt_ident.rb', line 417</span>

<span class='kw'>def</span> <span class='id identifier rubyid_session_expired?'>session_expired?</span>
  <span class='comment'># To be implemented.
</span><span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="sign_in-instance_method">
  
    #<strong>sign_in</strong>(user, password)  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Attempt to Authenticate a User, passing in an Entity for that User (which
<strong>must</strong> contain a <code>password_hash</code> attribute), and a Clear-Text Password.</p>

<p>On <em>success:</em></p>

<ul>
<li><code>session[:start_time]</code> is set to the current time as returned by
<code>Time.now</code> when called from within the method;</li>
<li><code>session[:current_user]</code> is set to tne <em>Entity</em> (not the ID value from the
Repository) for the successfully-Authenticated User. This is to eliminate
repeated reads of the Repository.</li>
</ul>

<p>On <em>failure:</em></p>

<ul>
<li><code>session[:start_time]</code> is set to <code>0000-01-01 00:00:00 +0000</code> (which should
<em>always</em> trigger <code>#session_expired?</code>)</li>
<li><code>session[:current_user]</code> is set to <code>config.guest_user</code></li>
</ul>

<p>If a <em>different User</em> is Authenticated (as evidenced by
<code>session[:current_user]</code>), then <code>sign_in</code> returns <code>false</code> and the <code>session</code>
data remains unchanged.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_config'>config</span><span class='rparen'>)</span>
  <span class='ivar'>@config</span> <span class='op'>=</span> <span class='id identifier rubyid_config'>config</span>
<span class='kw'>end</span>

<span class='kw'>def</span> <span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>
  <span class='kw'>true</span>
<span class='kw'>end</span>

<span class='kw'>def</span> <span class='id identifier rubyid_valid?'>valid?</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_user'>user</span> <span class='op'>=</span> <span class='const'>UserRepository</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='period'>.</span><span class='id identifier rubyid_find_by_email'>find_by_email</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:email</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='ivar'>@user</span> <span class='op'>=</span> <span class='id identifier rubyid_user'>user</span> <span class='op'>||</span> <span class='ivar'>@config</span><span class='period'>.</span><span class='id identifier rubyid_guest_user'>guest_user</span>
  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>unless</span> <span class='id identifier rubyid_user'>user</span>
  <span class='id identifier rubyid_sign_in'>sign_in</span><span class='lparen'>(</span><span class='ivar'>@user</span><span class='comma'>,</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:password</span><span class='rbracket'>]</span><span class='rparen'>)</span>
<span class='kw'>end</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>user</span>
      
      
        <span class='type'>(<tt>Object</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>Entity representing a User to be Authenticated;</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>password</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>Claimed Clear-Text Password for the specified User.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>0.1.0</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Required Authentication Status:</p>
<ul class="authenticated">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>Must not be authenticated.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Session Data Interacted With:</p>
<ul class="session_data">
  
    <li>
      
      
      
      
        
        <div class='inline'><p><code>:current_user</code> <strong>must not</strong> be other than <code>nil</code> or the Guest User.</p>

<p><code>:start_time</code> is set to either the current time (on success) or the
  distant past (on failure)</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Ubiquitous Language Terms:</p>
<ul class="ubiq_lang">
  
    <li>
      
      
      
      
        
        <div class='inline'><ul>
<li>Authenticated User</li>
<li>Authentication</li>
<li>Clear-Text Password</li>
<li>Entity</li>
<li>Guest User</li>
<li>Repository</li>
</ul>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


134
135
136</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/crypt_ident.rb', line 134</span>

<span class='kw'>def</span> <span class='id identifier rubyid_sign_in'>sign_in</span><span class='lparen'>(</span><span class='id identifier rubyid_user'>user</span><span class='comma'>,</span> <span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span>
  <span class='comment'># To be implemented.
</span><span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="sign_out-instance_method">
  
    #<strong>sign_out</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Sign out a previously Authenticated User.</p>

<p>If the <code>session[:current_user]</code> value <em>does not</em> have the value of <code>nil</code> or
<code>config.guest_user</code>, then <code>session[:start_time]</code> is set to
<code>0000-01-01 00:00:00 +0000</code>, and the method returns <code>true</code>.</p>

<p>If <code>session[:current_user]</code> <em>is</em> the Guest User, then
<code>session[:start_time]</code> is cleared as above, and the method returns
<code>false</code></p>

<p>In neither case is any data but the <code>session</code> values affected.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='kw'>def</span> <span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid__params'>_params</span><span class='rparen'>)</span>
  <span class='kw'>true</span>
<span class='kw'>end</span>

<span class='kw'>def</span> <span class='id identifier rubyid_valid?'>valid?</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>
  <span class='ivar'>@user_name</span> <span class='op'>=</span> <span class='id identifier rubyid_session'>session</span><span class='lbracket'>[</span><span class='symbol'>:current_user</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>
  <span class='id identifier rubyid_sign_out'>sign_out</span>
<span class='kw'>end</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>0.1.0</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Required Authentication Status:</p>
<ul class="authenticated">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>Must be authenticated.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Session Data Interacted With:</p>
<ul class="session_data">
  
    <li>
      
      
      
      
        
        <div class='inline'><p><code>:current_user</code> <strong>must not</strong> be other than <code>nil</code> or the Guest User; set to
  the Guest User value on completion;</p>

<p><code>:start_time</code> is set to the distant past (on success)</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Ubiquitous Language Terms:</p>
<ul class="ubiq_lang">
  
    <li>
      
      
      
      
        
        <div class='inline'><ul>
<li>Authenticated User</li>
<li>Authentication</li>
<li>Entity</li>
<li>Guest User</li>
<li>Repository</li>
</ul>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


175
176
177</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/crypt_ident.rb', line 175</span>

<span class='kw'>def</span> <span class='id identifier rubyid_sign_out'>sign_out</span>
  <span class='comment'># To be implemented.
</span><span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Tue Oct 30 03:24:26 2018 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.16 (ruby-2.5.3).
</div>

    </div>
  </body>
</html>